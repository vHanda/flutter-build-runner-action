name: 'Flutter Build Runner'
author: 'Vishesh Handa <me@vhanda.dev>'
description: 'Run the Flutter Build Runner'
branding:
  icon: 'maximize'
  color: 'blue'
inputs:
  output_paths:
    description: 'The output files generated by the build-runner'
    required: true
  input_paths:
    description: 'The Input Paths used by the build_runner. By default it matches all dart files and pubspec'
    default: '**/*.dart pubspec.* **/*.proto'
runs:
  using: "composite"
  steps:
    - run: Build Cache key
      id: cache-key
      shell: bash
      run: ./build_key.sh '${{ inputs.input_paths }}' >> $GITHUB_ENV
    - uses: actions/cache@v3
      name: Build Runner Cache
      id: fbrc
      with:
        path: ${{ inputs.output_paths }}
        key: fbrc_${{ runner.os }}_${{ env.FLUTTER_BUILD_RUNNER_KEY }}
    - name: Build Runner
      if: steps.fbrc.outputs.cache-hit != 'true'
      run: flutter pub run build_runner build
      shell: bash
